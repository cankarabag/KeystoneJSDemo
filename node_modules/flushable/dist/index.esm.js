// a timeout function that can be flushed and cancelled
var flushable = function flushable(onComplete, delay) {
  var timeoutId = setTimeout(function () {
    timeoutId = null;
    onComplete(false);
  }, delay);

  var clearTimer = function clearTimer() {
    if (timeoutId) {
      clearTimeout(timeoutId);
      timeoutId = null;
    }
  };

  return {
    cancel: clearTimer,
    flush: function flush() {
      if (!timeoutId) {
        return;
      }

      clearTimer();
      onComplete(true);
    },
    pending: function pending() {
      return Boolean(timeoutId);
    }
  };
};

export default flushable;
